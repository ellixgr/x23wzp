<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PAINEL ADMIN - Controle Total</title>
<style>
/* Estilos Base (Copiados do seu site) */
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Segoe UI',Roboto,Arial,sans-serif;background:#ebebeb;display:flex;flex-direction:column;align-items:center;min-height:100vh}
header{width:100%;padding:15px;background:#fff;text-align:center;box-shadow:0 2px 5px rgba(0,0,0,0.1);margin-bottom:20px}
header h1{color:#00008b;font-size:24px}

/* Login Screen */
#login-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;z-index:10000;display:flex;justify-content:center;align-items:center;flex-direction:column}
.login-box{background:#f9f9f9;padding:30px;border-radius:15px;box-shadow:0 5px 15px rgba(0,0,0,0.1);text-align:center}
.login-box input{display:block;width:250px;padding:12px;margin:10px auto;border-radius:8px;border:1px solid #ccc}
.login-box button{background:#b78cff;color:#fff;border:none;padding:12px 30px;border-radius:8px;font-weight:bold;cursor:pointer}

/* Grid de Grupos */
#lista-grupos{width:100%;max-width:420px;padding:20px;display:flex;flex-direction:column;gap:20px}
.grupo{width:100%;background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 4px 15px rgba(0,0,0,0.1);position:relative;text-decoration:none;color:#333}
.card-topo{position:relative;height:180px}
.foto{width:100%;height:100%;object-fit:cover}
.card-corpo{padding:15px}
.nome{font-size:18px;font-weight:bold;display:block}
.descricao{font-size:13px;color:#666;margin:10px 0}

/* Estilo VIP */
.grupo.vip{border:2px solid #ffd700;animation:brilho 2s infinite alternate}
@keyframes brilho{from{box-shadow:0 0 5px #ffd700}to{box-shadow:0 0 15px #ffd700}}

/* Botões Admin */
.admin-actions{display:flex;flex-wrap:wrap;gap:5px;padding:10px;background:#f0f0f0;border-top:1px solid #ddd}
.btn-adm{border:none;padding:8px 12px;border-radius:5px;cursor:pointer;font-weight:bold;color:#fff;font-size:12px}
.btn-edit{background:#2ecc71}
.btn-del{background:#e74c3c}
.btn-vip{background:#f1c40f;color:#000}

/* Modal */
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:11000}
.modal-content{background:#fff;padding:20px;border-radius:15px;width:90%;max-width:350px}
.modal-content input, .modal-content select{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:1px solid #ccc}
</style>
</head>
<body>

<div id="login-screen">
    <div class="login-box">
        <h2 style="margin-bottom:15px">Acesso Restrito Admin</h2>
        <input type="text" id="user" placeholder="Usuário Admin">
        <input type="password" id="pass" placeholder="Senha">
        <button onclick="checkLogin()">Entrar</button>
    </div>
</div>

<header>
    <h1>PAINEL DE CONTROLE</h1>
    <p>Você logou como: <b>HTTPS://</b></p>
</header>

<div id="lista-grupos"></div>

<div id="modalEdit" class="modal">
    <div class="modal-content">
        <h3>Editar Grupo (Poder Admin)</h3>
        <input type="text" id="editNome" placeholder="Nome do Grupo">
        <input type="text" id="editDesc" placeholder="Descrição Curta">
        <input type="text" id="editLink" placeholder="Link do WhatsApp">
        <input type="text" id="editFoto" placeholder="Link da Imagem (URL)">
        <select id="editCat">
            <option value="Amizade">Amizade</option>
            <option value="Zoeira">Zoeira</option>
            <option value="Namoro">Namoro</option>
        </select>
        <button onclick="salvarAdmin()" style="background:#2ecc71; width:100%; color:#fff; padding:10px; border:none; border-radius:8px; font-weight:bold; margin-top:10px">SALVAR ALTERAÇÕES</button>
        <button onclick="fecharModal()" style="background:#666; width:100%; color:#fff; padding:10px; border:none; border-radius:8px; margin-top:5px">CANCELAR</button>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, onValue, set, remove, update } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDsrYjO2yVTemKqwmJRzNjh5sfaMalPqhE",
  authDomain: "cliques-4a2c1.firebaseapp.com",
  databaseURL: "https://cliques-4a2c1-default-rtdb.firebaseio.com",
  projectId: "cliques-4a2c1",
  storageBucket: "cliques-4a2c1.firebase storage.app",
  messagingSenderId: "903875153255",
  appId: "1:903875153255:web:ff3cf25e059b10d665b3c2",
  measurementId: "G-BQ7FWRJD"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// LOGIN
window.checkLogin = function() {
    const u = document.getElementById('user').value;
    const p = document.getElementById('pass').value;
    if(u === "HTTPS://" && p === "cavalo777_") {
        document.getElementById('login-screen').style.display = 'none';
        carregarGrupos();
    } else {
        alert("Usuário ou Senha incorretos!");
    }
}

let grupoAtual = "";

function carregarGrupos() {
    onValue(ref(db, 'grupos'), (snapshot) => {
        const container = document.getElementById('lista-grupos');
        container.innerHTML = "";
        
        snapshot.forEach((child) => {
            const g = child.val();
            const key = child.key;
            
            const div = document.createElement('div');
            div.className = g.vip ? 'grupo vip' : 'grupo';
            div.innerHTML = `
                <div class="card-topo">
                    <img src="${g.foto}" class="foto">
                </div>
                <div class="card-corpo">
                    <span class="nome">${g.nome} ${g.vip ? '⭐' : ''}</span>
                    <p class="descricao">${g.descricao}</p>
                    <p style="font-size:10px; color:#999">Cliques: ${g.cliques || 0}</p>
                </div>
                <div class="admin-actions">
                    <button class="btn-adm btn-edit" onclick="abrirEdicao('${key}', '${g.nome}', '${g.descricao}', '${g.link}', '${g.foto}', '${g.categoria}')">EDITAR</button>
                    <button class="btn-adm btn-vip" onclick="toggleVip('${key}', ${g.vip})">${g.vip ? 'REMOVER VIP' : 'DAR VIP'}</button>
                    <button class="btn-adm btn-del" onclick="excluir('${key}')">EXCLUIR</button>
                </div>
            `;
            container.appendChild(div);
        });
    });
}

window.abrirEdicao = (key, nome, desc, link, foto, cat) => {
    grupoAtual = key;
    document.getElementById('editNome').value = nome;
    document.getElementById('editDesc').value = desc;
    document.getElementById('editLink').value = link;
    document.getElementById('editFoto').value = foto;
    document.getElementById('editCat').value = cat;
    document.getElementById('modalEdit').style.display = 'flex';
};

window.fecharModal = () => document.getElementById('modalEdit').style.display = 'none';

window.salvarAdmin = () => {
    const data = {
        nome: document.getElementById('editNome').value,
        descricao: document.getElementById('editDesc').value,
        link: document.getElementById('editLink').value,
        foto: document.getElementById('editFoto').value,
        categoria: document.getElementById('editCat').value
    };
    update(ref(db, 'grupos/' + grupoAtual), data).then(() => {
        alert("Atualizado com sucesso!");
        fecharModal();
    });
};

window.toggleVip = (key, statusAtual) => {
    update(ref(db, 'grupos/' + key), { vip: !statusAtual });
};

window.excluir = (key) => {
    if(confirm("Tem certeza que quer APAGAR esse grupo do site?")) {
        remove(ref(db, 'grupos/' + key));
    }
};
</script>
</body>
</html>
